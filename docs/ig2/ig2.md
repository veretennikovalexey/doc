# ig2.md

Диспетчерская (все заказы) - Документы - Заказы торговли / ездки - Заказы за смену

EDI заказ из файла i:\temp\exp1\ORDERS_MK_3127928898.xml

Диспетчерская (все заказы) - Документы - Добавление заказов из электронной почты

## EXEL_FROM_ZAK5 sg Сергей

1. Программа выполняет подготовительные действия: объявляет переменные, загружает параметры и настройки, проверяет наличие запущенных процессов приема заказов.

2. Обрабатывает архивные файлы: распаковывает архивы (RAR, ZIP и др.) во временные каталоги, извлекает файлы заказов (XLS, XLSX, XML, DBF) и перемещает их в рабочие каталоги.

3. Выполняет отбор и сортировку файлов заказов по различным схемам (Excel, EDI, DBF, ADT, COMERS) в зависимости от конфигурации и параметров.

4. Обрабатывает файлы Excel: извлекает данные из ячеек (даты, магазины, продукцию, количество, время доставки, примечания), проверяет корректность данных и соответствие справочникам.

5. Обрабатывает файлы EDI: преобразует XML-структуры в данные заказов, проверяет коды магазинов и продукции, формирует ответы на заказы.

6. Обрабатывает файлы DBF и другие форматы: загружает данные по соответствующим схемам.

7. Добавляет данные заказов в базу данных: обновляет или создает записи в документах заказов (ZAK), учитывает корректировки и отмены, разделяет заказы по экспедициям.

8. Отправляет подтверждения и ответы: формирует и отправляет электронные письма с результатами обработки заказов, отправляет файлы в подразделения.

9. Выполняет завершающие действия: закрывает соединения с базой данных, освобождает ресурсы, удаляет обработанные файлы, записывает ошибки в лог-файлы.

## R525 e-mail-ы по контрагентам

Используется для работы справочник

[R525  e-mail-ы по контрагентам](https://wiki.sftserv.ru/index.php/R525)